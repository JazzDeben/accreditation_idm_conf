{
    "mappings" : [
        {
            "name" : "systemPartnersAccount_systemWebportalAccount",
            "source" : "system/Partners/account",
            "target" : "system/Webportal/account",
            "policies" : [
                {
                    "action" : "EXCEPTION",
                    "situation" : "AMBIGUOUS"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "SOURCE_MISSING"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "MISSING"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "FOUND_ALREADY_LINKED"
                },
                {
                    "action" : "DELETE",
                    "situation" : "UNQUALIFIED"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "UNASSIGNED"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "LINK_ONLY"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "TARGET_IGNORED"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "SOURCE_IGNORED"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "ALL_GONE"
                },
                {
                    "action" : "UPDATE",
                    "situation" : "CONFIRMED"
                },
                {
                    "action" : "UPDATE",
                    "situation" : "FOUND"
                },
                {
                    "action" : "CREATE",
                    "situation" : "ABSENT"
                }
            ],
            "properties" : [
                {
                    "source" : "mail",
                    "target" : "mail"
                },
                {
                    "source" : "telephoneNumber",
                    "target" : "telephoneNumber"
                },
                {
                    "source" : "userPassword",
                    "target" : "userPassword"
                },
                {
                    "source" : "uid",
                    "target" : "uid"
                },
                {
                    "source" : "description",
                    "target" : "description"
                },
                {
                    "source" : "employeeType",
                    "target" : "employeeType"
                },
                {
                    "source" : "givenName",
                    "target" : "givenName"
                },
                {
                    "source" : "kbaInfo",
                    "target" : "kbaInfo"
                },
                {
                    "source" : "objectClass",
                    "target" : "objectClass"
                },
                {
                    "source" : "sn",
                    "target" : "sn"
                },
                {
                    "source" : "",
                    "target" : "dn",
                    "transform" : {
                        "type" : "text/javascript",
                        "source" : "let dn = \"\";\nlogger.warn(\">>> Script looking at user: \" + source.uid + \" Partner: \" + source.partnerOrg + \" <<<\");\nswitch (source.partnerOrg) {\n  case \"partner1.com\":\n    logger.warn(\">>> Script Partner is : \" + source.partnerOrg);\n    dn = \"uid=\"+source.uid+\",ou=partner1.com,dc=partner,dc=example,dc=com\";\n    break;\n  case \"partner2.com\":\n    logger.warn(\">>> Script Partner is : \" + source.partnerOrg);\n    dn = \"uid=\"+source.uid+\",ou=partner2.com,dc=partner,dc=example,dc=com\";\n    break;\n  case \"partner3.com\":\n    logger.warn(\">>> Script Partner is : \" + source.partnerOrg);\n    dn = \"uid=\"+source.uid+\",ou=partner3.com,dc=partner,dc=example,dc=com\";\n    break;\n  case \"partner4.com\":\n    logger.warn(\">>> Script Partner is : \" + source.partnerOrg);\n    dn = \"uid=\"+source.uid+\",ou=partner4.com,dc=partner,dc=example,dc=com\";\n}   \n\ndn;",
                        "globals" : { }
                    }
                },
                {
                    "source" : "partnerOrg",
                    "target" : "partnerOrg"
                },
                {
                    "source" : "lastLoginTime",
                    "target" : "lastLoginTime"
                },
                {
                    "source" : "userRole",
                    "target" : "userRole"
                },
                {
                    "source" : "",
                    "target" : "cn",
                    "transform" : {
                        "type" : "text/javascript",
                        "source" : "source.givenName + ' ' + source.sn",
                        "globals" : { }
                    }
                }
            ],
            "displayName" : "systemPartnersAccount_systemWebportalAccount",
            "sourceQuery" : {
                "_queryFilter" : "((/userRole eq \"standard_user\" or /userRole eq \"power_user\" or /userRole eq \"lite_user\" or !(/userRole eq \"UNKNOWN\")) and /lastLoginTime ge \"20140101000000Z\" and (partnerOrg eq \"partner1.com\" or partnerOrg eq \"partner2.com\" or partnerOrg eq \"partner3.com\" or partnerOrg eq \"partner4.com\"))"
            },
            "targetQuery" : {
                "_queryFilter" : "(/userRole eq \"standard_user\" or /userRole eq \"power_user\" or /userRole eq \"lite_user\" or !(/userRole eq \"UNKNOWN\"))"
            },
            "correlationQuery" : [
                {
                    "file" : "ui/correlateTreeToQueryFilter.js",
                    "type" : "text/javascript",
                    "mapping" : "systemPartnersAccount_systemWebportalAccount",
                    "linkQualifier" : "default",
                    "expressionTree" : {
                        "all" : [
                            "uid",
                            "userRole"
                        ]
                    }
                }
            ],
            "reconSourceQueryPageSize" : 100,
            "clusteredSourceReconEnabled" : true
        },
        {
            "name" : "systemActivedirectoryAccount_managedUser",
            "source" : "system/ActiveDirectory/account",
            "target" : "managed/user",
            "policies" : [
                {
                    "action" : "EXCEPTION",
                    "situation" : "AMBIGUOUS"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "SOURCE_MISSING"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "MISSING"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "FOUND_ALREADY_LINKED"
                },
                {
                    "action" : "DELETE",
                    "situation" : "UNQUALIFIED"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "UNASSIGNED"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "LINK_ONLY"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "TARGET_IGNORED"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "SOURCE_IGNORED"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "ALL_GONE"
                },
                {
                    "action" : "UPDATE",
                    "situation" : "CONFIRMED"
                },
                {
                    "action" : "UPDATE",
                    "situation" : "FOUND"
                },
                {
                    "action" : "CREATE",
                    "situation" : "ABSENT"
                }
            ],
            "properties" : [
                {
                    "source" : "sAMAccountName",
                    "target" : "userName"
                },
                {
                    "source" : "givenName",
                    "target" : "givenName"
                },
                {
                    "source" : "sn",
                    "target" : "sn"
                },
                {
                    "source" : "",
                    "target" : "mail",
                    "transform" : {
                        "type" : "text/javascript",
                        "source" : "let mail = \"\";\nlogger.warn(\">>> SCRIPT EMAIL <<<\");\nif (source.mail == undefined){\n  logger.warn(\">>> SCRIPT EMAIL mail undefined <<<\");\n  mail = findEmailInOtherAttribute();\n} else {\n  logger.warn(\">>> SCRIPT EMAIL mail defined <<<\");\n  if (source.mail.indexOf(\"@\" > 0)){\n    logger.warn(\">>> SCRIPT EMAIL mail: \" + source.mail + \" <<<\");\n    mail = source.mail ;\n  } else {\n    logger.warn(\">>> SCRIPT EMAIL mail defined but rejected <<<\");\n    mail = findEmailInOtherAttribute();\n  }\n}\n\nfunction findEmailInOtherAttribute(){\n  let proxyAddress = \"\";\n  logger.warn(\">>> SCRIPT EMAIL looking for proxyAddresses attribute value <<<\");\n  if ((source.proxyAddresses != undefined) && (Array.isArray(source.proxyAddresses))){\n    if(source.proxyAddresses[0] != undefined){\n      if((source.proxyAddresses[0].indexOf(\"@\") > 0) && (source.proxyAddresses[0].indexOf(\":\") > 0)){\n        logger.warn(\">>> SCRIPT EMAIL proxyAddresses value is: \" + source.proxyAddresses[0] + \" <<<\");\n        proxyAddress = source.proxyAddresses[0].substring((source.proxyAddresses[0].indexOf(\":\") + 1), source.proxyAddresses[0].length);\n      } else {\n        logger.warn(\">>> SCRIPT EMAIL proxyAddresses not valid: \" + source.proxyAddresses[0] + \" <<<\");\n      }\n    } else {\n      logger.warn(\">>> SCRIPT EMAIL proxyAddresses is undefined <<<\");\n    }\n  }\n  return proxyAddress;\n}\n\nmail;",
                        "globals" : { }
                    }
                },
                {
                    "source" : "employeeID",
                    "target" : "employeeid"
                },
                {
                    "source" : "cn",
                    "target" : "cn"
                },
                {
                    "source" : "displayName",
                    "target" : "name"
                },
                {
                    "source" : "",
                    "target" : "password",
                    "transform" : {
                        "type" : "text/javascript",
                        "source" : "let pwd = openidm.read(\"endpoint/passwordGenerator\");\nlogger.warn(\">>> SCRIPT password for \" + source.employeeID + \" is: \" + pwd.password + \" <<<\");\npwd.password;",
                        "globals" : { }
                    }
                },
                {
                    "source" : "",
                    "target" : "validMail",
                    "default" : false,
                    "transform" : {
                        "type" : "text/javascript",
                        "source" : "(/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(source.mail)) ? true : false;",
                        "globals" : { }
                    }
                }
            ],
            "displayName" : "systemActivedirectoryAccount_managedUser",
            "sourceQuery" : {
                "_queryFilter" : "(employeeID pr and !(displayName sw \"ADMIN\"))"
            },
            "targetQuery" : {
                "_queryFilter" : "/employeeID pr"
            },
            "correlationQuery" : [
                {
                    "file" : "ui/correlateTreeToQueryFilter.js",
                    "type" : "text/javascript",
                    "mapping" : "systemActivedirectoryAccount_managedUser",
                    "linkQualifier" : "default",
                    "expressionTree" : {
                        "any" : [
                            "employeeid"
                        ]
                    }
                }
            ],
            "clusteredSourceReconEnabled" : true
        },
        {
            "name" : "systemMysql__ACCOUNT___managedUser",
            "source" : "system/MySQL/__ACCOUNT__",
            "target" : "managed/user",
            "policies" : [
                {
                    "action" : "EXCEPTION",
                    "situation" : "AMBIGUOUS"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "SOURCE_MISSING"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "MISSING"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "FOUND_ALREADY_LINKED"
                },
                {
                    "action" : "DELETE",
                    "situation" : "UNQUALIFIED"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "UNASSIGNED"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "LINK_ONLY"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "TARGET_IGNORED"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "SOURCE_IGNORED"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "ALL_GONE"
                },
                {
                    "action" : "UPDATE",
                    "situation" : "CONFIRMED"
                },
                {
                    "action" : "UPDATE",
                    "situation" : "FOUND"
                },
                {
                    "action" : "CREATE",
                    "situation" : "ABSENT"
                }
            ],
            "properties" : [
                {
                    "source" : "__NAME__",
                    "target" : "employeeid",
                    "transform" : {
                        "type" : "text/javascript",
                        "source" : "/*if(target.employeeid != undefined){\n  logger.warn(\">>>SCRIPT EMPLOYEEID TARGET: \" + target.employeeid + \" <<<\");\n} else {\n  logger.warn(\">>>SCRIPT EMPLOYEEID NOT FOUND HERE <<<\");\n}*/\n\nlogger.warn(\">>> ************** SCRIPT EMPLOYEEID GETTING: \" + source + \" ************** <<<\");\nlet id = source;\nwhile(id.length < 6){\n  id = \"0\" + id;\n}\nlogger.warn(\">>> SCRIPT EMPLOYEEID CHANGE IT TO: \" + id + \" <<<\");\nid;",
                        "globals" : { }
                    }
                },
                {
                    "source" : "city",
                    "target" : "city"
                },
                {
                    "source" : "address",
                    "target" : "address"
                },
                {
                    "source" : "state",
                    "target" : "state"
                },
                {
                    "source" : "country",
                    "target" : "country"
                },
                {
                    "source" : "phone",
                    "target" : "telephone"
                },
                {
                    "source" : "zip",
                    "target" : "zip"
                },
                {
                    "source" : "dob",
                    "target" : "dob"
                },
                {
                    "source" : "",
                    "target" : "validPhone",
                    "default" : false,
                    "transform" : {
                        "type" : "text/javascript",
                        "source" : "(source.phone.search(/[a-zA-Z]/) >= 0) ? false : true;",
                        "globals" : { }
                    }
                }
            ],
            "displayName" : "systemMysql__ACCOUNT___managedUser",
            "correlationQuery" : [
                {
                    "type" : "text/javascript",
                    "source" : "logger.warn(\">>> ************ CORRELATION SCRIPT *********** <<<\");\nlogger.warn(\">>> SOURCE NAME: \" + source.__NAME__ + \" <<<\");\nlet id = source.__NAME__;\nwhile(id.length < 6){\n  id = \"0\" + id;\n}\nlogger.warn(\">>> SOURCE ID: \" + id + \" <<<\");\n\nlet query = {'_queryFilter': 'employeeid eq \\\"' + id +'\\\"' };\nquery;\n",
                    "globals" : { },
                    "linkQualifier" : "default"
                }
            ],
            "clusteredSourceReconEnabled" : true
        },
        {
            "name" : "managedUser_systemWebportalAccount",
            "source" : "managed/user",
            "target" : "system/Webportal/account",
            "policies" : [
                {
                    "action" : "EXCEPTION",
                    "situation" : "AMBIGUOUS"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "SOURCE_MISSING"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "MISSING"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "FOUND_ALREADY_LINKED"
                },
                {
                    "action" : "DELETE",
                    "situation" : "UNQUALIFIED"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "UNASSIGNED"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "LINK_ONLY"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "TARGET_IGNORED"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "SOURCE_IGNORED"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "ALL_GONE"
                },
                {
                    "action" : "UPDATE",
                    "situation" : "CONFIRMED"
                },
                {
                    "action" : "UPDATE",
                    "situation" : "FOUND"
                },
                {
                    "action" : "CREATE",
                    "situation" : "ABSENT"
                }
            ],
            "properties" : [
                {
                    "source" : "mail",
                    "target" : "mail"
                },
                {
                    "source" : "userName",
                    "target" : "uid"
                },
                {
                    "source" : "givenName",
                    "target" : "givenName"
                },
                {
                    "source" : "employeeid",
                    "target" : "uid"
                },
                {
                    "source" : "cn",
                    "target" : "cn"
                },
                {
                    "source" : "sn",
                    "target" : "sn"
                },
                {
                    "source" : "telephone",
                    "target" : "telephoneNumber"
                },
                {
                    "source" : "",
                    "target" : "registeredAddress",
                    "transform" : {
                        "type" : "text/javascript",
                        "source" : "source.address + \", \" + source.city + \", \" + source.state + \", \" + source.zip + \", \" + source.country",
                        "globals" : { }
                    }
                },
                {
                    "source" : "",
                    "target" : "dn",
                    "transform" : {
                        "type" : "text/javascript",
                        "source" : "\"uid=\"+source.employeeid+\",ou=People,dc=employees,dc=example,dc=com\";",
                        "globals" : { }
                    }
                },
                {
                    "source" : "password",
                    "target" : "userPassword",
                    "condition" : {
                        "type" : "text/javascript",
                        "source" : "object.password != null",
                        "globals" : { }
                    },
                    "transform" : {
                        "type" : "text/javascript",
                        "source" : "logger.warn(\">>> PASSWORD DECRYPT AND SYNC <<<\");\nlogger.warn(\">>> PASSWORD IS: \" + openidm.decrypt(source) + \" <<<\");\nopenidm.decrypt(source);",
                        "globals" : { }
                    }
                }
            ],
            "displayName" : "managedUser_systemWebportalAccount",
            "sourceQuery" : {
                "_queryFilter" : "(!(/validPhone eq \"false\") and !(validMail eq \"false\") and employeeid pr)"
            },
            "targetQuery" : {
                "_queryFilter" : "!(/registeredAddress sw \"0\")"
            },
            "correlationQuery" : [
                {
                    "file" : "ui/correlateTreeToQueryFilter.js",
                    "type" : "text/javascript",
                    "mapping" : "managedUser_systemWebportalAccount",
                    "linkQualifier" : "default",
                    "expressionTree" : {
                        "all" : [
                            "uid"
                        ]
                    }
                }
            ],
            "clusteredSourceReconEnabled" : true
        },
        {
            "name" : "managedUser_systemActivedirectoryAccount",
            "links" : "systemActivedirectoryAccount_managedUser",
            "source" : "managed/user",
            "target" : "system/ActiveDirectory/account",
            "policies" : [
                {
                    "action" : "EXCEPTION",
                    "situation" : "AMBIGUOUS"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "SOURCE_MISSING"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "MISSING"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "FOUND_ALREADY_LINKED"
                },
                {
                    "action" : "DELETE",
                    "situation" : "UNQUALIFIED"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "UNASSIGNED"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "LINK_ONLY"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "TARGET_IGNORED"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "SOURCE_IGNORED"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "ALL_GONE"
                },
                {
                    "action" : "UPDATE",
                    "situation" : "CONFIRMED"
                },
                {
                    "action" : "UPDATE",
                    "situation" : "FOUND"
                },
                {
                    "action" : "CREATE",
                    "situation" : "ABSENT"
                }
            ],
            "properties" : [
                {
                    "source" : "",
                    "target" : "password",
                    "condition" : {
                        "type" : "text/javascript",
                        "source" : "object.password != null",
                        "globals" : { }
                    },
                    "transform" : {
                        "type" : "text/javascript",
                        "source" : "logger.warn(\">>> AD SCRIPT DECODING PASSWORD <<<\");\nlogger.warn(\">>> AD SCRIPT DECODING: \" + openidm.decrypt(source.password) + \" <<<\");\nlogger.warn(\">>> AD SCRIPT USER: \" + source.userName + \" <<<\");\nopenidm.decrypt(source.password);",
                        "globals" : { }
                    }
                },
                {
                    "source" : "userName",
                    "target" : "sAMAccountName",
                    "condition" : {
                        "type" : "text/javascript",
                        "source" : "false;",
                        "globals" : { }
                    },
                    "transform" : {
                        "type" : "text/javascript",
                        "source" : "logger.warn(\">>> USERNAME: \" + source + \" <<<\");\nsource;",
                        "globals" : { }
                    }
                }
            ],
            "displayName" : "managedUser_systemActivedirectoryAccount",
            "correlationQuery" : [
                {
                    "type" : "text/javascript",
                    "source" : "logger.warn(\">>> SCRIPT AD Account (sAMAccountName): \" + source.userName + \" <<<\");\nvar qry = {'_queryFilter': 'sAMAccountName eq \\\"' + source.userName + '\\\"'}; \nqry;",
                    "globals" : { },
                    "linkQualifier" : "default"
                }
            ],
            "clusteredSourceReconEnabled" : true
        },
        {
            "icon" : null,
            "name" : "systemDevices__ACCOUNT___managedDevice",
            "source" : "system/Devices/__ACCOUNT__",
            "target" : "managed/device",
            "policies" : [
                {
                    "action" : "EXCEPTION",
                    "situation" : "AMBIGUOUS"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "SOURCE_MISSING"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "MISSING"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "FOUND_ALREADY_LINKED"
                },
                {
                    "action" : "DELETE",
                    "situation" : "UNQUALIFIED"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "UNASSIGNED"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "LINK_ONLY"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "TARGET_IGNORED"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "SOURCE_IGNORED"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "ALL_GONE"
                },
                {
                    "action" : "UPDATE",
                    "situation" : "CONFIRMED"
                },
                {
                    "action" : "UPDATE",
                    "situation" : "FOUND"
                },
                {
                    "action" : "CREATE",
                    "situation" : "ABSENT"
                }
            ],
            "properties" : [
                {
                    "source" : "__NAME__",
                    "target" : "serialNumber"
                },
                {
                    "source" : "dateIssued",
                    "target" : "dateIssued"
                },
                {
                    "source" : "deviceType",
                    "target" : "deviceType"
                },
                {
                    "source" : "renewalDate",
                    "target" : "renewalDate"
                },
                {
                    "source" : "",
                    "target" : "owner",
                    "transform" : {
                        "type" : "text/javascript",
                        "source" : "if(source.owner != undefined){\n  logger.warn(\">>> SCRIPT OWNER: \" + source.owner + \" <<<\");\n  let query = \"userName eq \\\"\" + source.owner + \"\\\"\";\n  let owner = openidm.query(\"managed/user\", {\"_queryFilter\": query});\n  \n  if (owner.result.length > 0) {\n    logger.warn(\">>> SCRIPT OWNER userName: \" + owner.result[0].userName + \" <<<\");\n    ({ \"_ref\" : \"managed/user/\" + owner.result[0]._id});\n  }\n}                                             ",
                        "globals" : { }
                    }
                }
            ],
            "displayName" : "systemDevices__ACCOUNT___managedDevice",
            "consentRequired" : false
        },
        {
            "icon" : null,
            "name" : "systemDevicedetails__ACCOUNT___managedDevicedetai",
            "source" : "system/DeviceDetails/__ACCOUNT__",
            "target" : "managed/deviceDetails",
            "policies" : [
                {
                    "action" : "EXCEPTION",
                    "situation" : "AMBIGUOUS"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "SOURCE_MISSING"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "MISSING"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "FOUND_ALREADY_LINKED"
                },
                {
                    "action" : "DELETE",
                    "situation" : "UNQUALIFIED"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "UNASSIGNED"
                },
                {
                    "action" : "EXCEPTION",
                    "situation" : "LINK_ONLY"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "TARGET_IGNORED"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "SOURCE_IGNORED"
                },
                {
                    "action" : "IGNORE",
                    "situation" : "ALL_GONE"
                },
                {
                    "action" : "UPDATE",
                    "situation" : "CONFIRMED"
                },
                {
                    "action" : "UPDATE",
                    "situation" : "FOUND"
                },
                {
                    "action" : "CREATE",
                    "situation" : "ABSENT"
                }
            ],
            "properties" : [
                {
                    "source" : "deviceType",
                    "target" : "deviceType"
                },
                {
                    "source" : "manufacturer",
                    "target" : "manufacturer"
                },
                {
                    "source" : "model",
                    "target" : "model"
                },
                {
                    "source" : "releaseDate",
                    "target" : "releaseDate"
                },
                {
                    "source" : "__NAME__",
                    "target" : "supportContractIdentifier"
                },
                {
                    "target" : "deviceSerial",
                    "transform" : {
                        "type" : "text/javascript",
                        "globals" : { },
                        "source" : "if(source.contractNumber !== \"unassigned\")\n{\n  logger.warn(\">>> DEVICE DETAILS SETTING UP DEVICE SERIAL RELATIONSHIP: \" + source.contractNumber + \" <<<\");\n  let contractQuery = openidm.query(\"managed/device\", { \"_queryFilter\": \"serialNumber eq \\\"\" + source.contractNumber + \"\\\"\"});\n  \n  if(contractQuery.result.length > 0)\n  {\n    logger.warn(\">>> DEVICE DETAILS SETTING UP _ID: \" + contractQuery.result[0]._id + \" <<<\");\n\n    ( { _ref : \"managed/device/\" + contractQuery.result[0]._id });\n  }\n}"
                    },
                    "source" : ""
                }
            ],
            "displayName" : "systemDevicedetails__ACCOUNT___managedDevicedetai",
            "consentRequired" : false
        }
    ]
}